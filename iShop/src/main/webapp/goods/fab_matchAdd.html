<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="renderer" content="webkit">
    <title>新增搭配</title>
    <link href="../css/bootstrap.min.css?v=3.4.0" rel="stylesheet">
    <link href="../font-awesome/css/font-awesome.css?v=4.3.0" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="../css/jquery.searchableSelect.css?2017040170331">
    <link href="../css/style.css?20170714" rel="stylesheet">
    <link rel="stylesheet" href="../css/font_style.css?2017040170331">
    <link rel="stylesheet" type="text/css" href="../css/diyUpload.css?2017040170331">
    <link rel="stylesheet" type="text/css" href="../css/tips.css?2017040170331">
    <link rel="stylesheet" type="text/css" href="../js/artDialog/skins/default.css?2017040170331">
    <script src="../js/loading.js?2017040170331"></script>
    <style>
        div{
            width: 100%;
        }
        body{
            margin-top:81px;
        }
        .good_imgs .fileBoxUl .check_public{
            width: 16px;
            height: 16px;
            background-color: #d5d5d5;
            border-radius: 15px;
            position: absolute;
            left: -15px;
            top: 8px;
            background-size: 22px 22px;
            margin-left: 28px;
        }
        #edit div{margin-bottom: 0px;}
        #edit{ margin-left: 120px;width: 420px; margin-top: -20px;}
        .add span{font-size: 20px;margin-left: 5px;}
        .match_goods ul{width:420px;height:250px;margin-left:120px;margin-top: 5px;overflow-y: auto;overflow-x: hidden;}
        .match_goods ul li{width:410px;height:50px;margin:auto;padding-top:5px;border-bottom: 1px solid rgba(255,255,255,0.4);}
        .match_goods ul li span:nth-child(3){margin-left: 20px;width:150px;display:inline-flex;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
        .match_goods .icon-ishop_6-12{float:right;margin:10px;font-size: 20px;color: #c26555;}
        .goodsImg{width:40px;height:40px;margin:0 10px;border-radius:5px;border: 1px solid #dbdbdb; }
        #search_match_goods .icon-ishop_6-12{float: right;font-size: 20px;padding: 5px;cursor:pointer;}
        #search_match_goods{width:450px;min-height:460px;overflow:hidden;font-size: 14px;color:#888888;background: #FFFFFF;box-shadow:0 0 10px rgba(0,0,0,0.35);border-radius: 10px;display:none}
        #search{width:400px;height:30px;border-radius:9px;outline: none;padding-left: 10px;padding-right: 30px;border: 1px solid #d7d7d7;;margin: 20px 20px;color:#888;}
        #search::-webkit-input-placeholder { /* WebKit browsers */
            color: #888;
        }
        #search:-moz-placeholder { /* Mozilla Firefox 4 to 18 */
            color: #888;
        }
        #search::-moz-placeholder { /* Mozilla Firefox 19+ */
            color: #888;
        }
        #search:-ms-input-placeholder { /* Internet Explorer 10+ */
            color: #888;
        }
        #d_search{float: right;position: absolute;  top:49px;  right: 32px;  font-size: 32px;color: #DCDCDC;}
        #goods_box{width:100%;height:1200px;position:absolute;top:45%;left: 20%;z-index: 100;display: none;}
        #search_match_goods .li{margin-bottom: 0;height:100px;}
        #search_match_goods ul{ width:425px;height:350px;overflow-y:auto;overflow-x: hidden;margin-left:20px; margin-bottom: 20px}
        #search_match_goods ul li{width:400px;height:50px;background:#ededed;padding-top:5px;display: inline-block; }
        #search_match_goods ul li:nth-child(even){background: #FFFFFF;}
        #search_match_goods ul li span:nth-child(3){margin-left: 20px;width:150px;display:inline-flex;overflow:hidden;text-overflow:ellipsis;white-space:nowrap; }
        #search_match_goods ul li i{position:relative;right:5px;top:8px;color: #c26555;display: none;cursor: pointer;}
        .goods_add{width: 40px;height:50px;float:right;font-size: 30px;  margin-top: -5px; text-align: center;  line-height: 50px;color:#c3c3c3; }
        .goods_add:hover{color:#6dc1c8;cursor: pointer;}
        .bttn-wrapper .fr-bttn:last-child{display: none;}
        .bttn-wrapper .fr-bttn:nth-last-of-type(4){display: none}
        /*添加*/
        #add{border: 2px dashed #c3c3c3;width: 150px;height: 150px;line-height: 130px;text-align: center;position: relative;margin-bottom: 60px;float: left;margin-right: 15px;}
        .addAdd{color: #c3c3c3;font-size:80px;position: absolute;top:0px;}
        .addText{position: absolute;top:40px;font-size:14px;color: #c3c3c3;}
        .conpany_msg li{width: 150px;height: 190px;margin-bottom: 10px;float: left;margin-right:15px;position: relative;}
        .conpany_msg img{width:150px;height:150px;border-radius: 5px;background-color: #ffffff;margin:0 auto;}
        .conpany_msg  span:nth-of-type(1){display:block; width: 150px;height: 30px;margin-top: 10px;font-size: 14px;color: #888888;text-align: center;margin-right: 20px}
        /*文字*/
        .conpany_msg span:nth-of-type(2){display: none;}
        /*删除*/
        .conpany_msg i{display:none;background-color: #e58080;color: white;border-radius: 300px;width: 17px;height: 17px;position: absolute;top: -7px;right: -7px;text-align: center;line-height: 17px;}
        #d_search:hover{
            cursor:hand;
            cursor:pointer
        }
        .error_tips{
            clear: both;
        }
        .hint{
            padding-bottom: 15px;
        }
    </style>
</head>
<body style="margin-right: 200px">
<div id="page-wrapper" class="gray-bg dashbard-1">
    <div class="col-lg-12 pre_title"><span>商品管理</span><i class="icon-ishop_8-03"></i><span onclick="changePage()">搭配管理</span><i class="icon-ishop_8-03"></i><label>新增搭配</label></div>
    <div class="editor_em col-lg-7 editor_line  animated fadeInRight">
        <!--搭配名称-->
        <div style="margin-top: 50px;">
           <span>
               <label style="font-size:14px;color:#c26555;float: left;width: 105px;height: 30px;text-align: right;margin-right: 18px;line-height: 30px;font-size: 14px;text-indent: 10px;">搭配名称*</label>
                <input type="text" id="goodsTitle"  verify="Empty"  style="margin-bottom:15px;float: left;width: 480px;height: 30px;border-radius: 4px;border: none;text-indent: 10px;outline: none;color: #888888" maxlength="200"/>
                <div style="padding-left:125px" class="hint">
                    <div hintinfo="搭配名称不能为空！"></div>
                </div>
            </span>
        </div>
        <div class="dapei" style="clear: both;">
            <div class="dapei_left">
                搭配效果图
            </div>
            <div class="daipei_right">
                <div class="daipei_list" id="daipei_list">
                    <ul>
                        <li class="add">
                            <input accept="image/jpg,image/jpeg,image/png,img/bmp"  type="file" name="upload" id="upFile"/>
                            <div class="addAdd">
                                +
                                <div class="addText">添加图片</div>
                            </div>
                            <div class="jianyi">建议尺寸：1000*1000</div>
                        </li>
                    </ul>
                </div>
            </div>
            <!--</div>-->
            <!--搭配描述-->
            <div style="clear:both;">
            <span style="display: inline-flex;width:100%;">
                <label style="font-size:14px;color:#c26555;float: left;width: 105px;height: 30px;text-align: right;margin-right: 18px;line-height: 30px;font-size: 14px;">搭配描述*</label>
                <textarea id="goodsDescribe" maxlength="600" style="width: 480px;height: 180px;padding: 8px;outline:none;resize: none;border: none; border-radius: 4px;font-family: inherit;font-size: inherit;line-height: inherit;" id="message_content" ></textarea></span></span>
            </div>
            <div style="padding-bottom: 10px" class="hint" id="areaTemp">
                <div hintinfo="搭配描述不能为空！" class="error_tips"style="">搭配描述不能为空！</div>
            </div>
            <span style="clear:both;float: left;font-size: 14px;color: #c26555;margin-top: 10px;width: 105px;text-align: right;">商品搭配*</span>
            <form class="conpany_msg" style="float: left;margin-top: 15px;margin-left: 20px;width: 495px">
                <!--商品模板-->
                <!--<div class="itembox" style="width: 150px;height: 190px;margin-bottom: 20px;margin-right:20px;float: left">-->
                <!--<div class="itemArea"></div>-->
                <!--<div class="itemText">AJEL55598</div>-->
                <!--</div>-->
                <!--添加模板-->
                <div id="add">
                    <div class="addAdd">+</div>
                    <div class="addText">添加商品</div>
                </div>
            </form>
        </div>
    </div>
    <div id="search_match_goods" style="top:50px;left:250px;position: absolute;z-index: 1000;" onmousedown="mouseDown(this,event)"
         onmousemove="mouseMove(event)" onmouseup="mouseUp(event)">
        <i class="icon-ishop_6-12" id="close_match_goods"></i>
        <div class="li">
            <input type="text" class="input" id="search" placeholder="商品编号/商品名称">
            <i class="icon-ishop_3-05" id="d_search"></i>
        </div>
        <ul id="stop"  onmousedown=" stopBubble(this.id)" onmousemove=" stopBubble(this.id)" onmouseup=" stopBubble(this.id)">

        </ul>
        <div id="more" class="more">加载更多<i class="icon-ishop_6-18"></i></div>
    </div>
    <div class="editor_detail col-lg-4  col-md-7 animated fadeInRight">
        <div class="fabadd_oper_btn">
            <ul>
                <li class="edit_save"><i class="icon-ishop_6-04"></i>保存</li>
                <li class="edit_close" id="edit_close"><i class="icon-ishop_6-12"></i>关闭</li>
            </ul>
        </div>
        <form class="msg_detail">
            <div>
                <span><label>可用</label><em class="checkbox_isactive"><input type="checkbox" value="" name="test" class="check" checked="checked"  id="is_active"><label for="is_active"></label></em></span>
            </div>
        </form>
    </div>
</div>
<script src="https://gosspublic.alicdn.com/aliyun-oss-sdk-4.3.0.min.js"></script>
<div style="display:none"><div id="container"><div id="selectfiles"></div></div></div>
<div id="goods_box"></div>
<!-- ajax -->
<script type="text/javascript" src="../js/insidePostRequire.js?2017040170331"></script>
<!-- 带搜索的下拉框 -->
<script type="text/javascript" src="../js/jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="../js/artDialog/jquery.artDialog.js"></script>
<!--匹配js文件-->
<script type="text/javascript" src="../js/goods/fab_matchAdd.js?2017040170331"></script>
<script>
    var mouseX, mouseY;
    var objX, objY;
    var isDowm = false;  //是否按下鼠标
    function mouseDown(obj, e) {
        obj.style.cursor = "move";
        objX = obj.style.left;
        objY = obj.style.top;
        mouseX = e.clientX;
        mouseY = e.clientY;
        isDowm = true;
    }
    function mouseMove(e) {
        var div = document.getElementById("search_match_goods");
        var x = e.clientX;
        var y = e.clientY;
        if (isDowm) {
            div.style.left = parseInt(objX) + parseInt(x) - parseInt(mouseX) + "px";
            div.style.top = parseInt(objY) + parseInt(y) - parseInt(mouseY) + "px";
        }
    }
    function mouseUp(e) {
        if (isDowm) {
            var x = e.clientX;
            var y = e.clientY;
            var div = document.getElementById("search_match_goods");
            div.style.left = (parseInt(x) - parseInt(mouseX) + parseInt(objX)) + "px";
            div.style.top = (parseInt(y) - parseInt(mouseY) + parseInt(objY)) + "px";
//            mouseX = x;
//            rewmouseY = y;
            div.style.cursor = "default";
            isDowm = false;
        }
    }
    function stopBubble(e) {
        if (e && e.stopPropagation) {//非IE浏览器
            e.stopPropagation();
        }
        else {//IE浏览器
            window.event.cancelBubble = true;
        }
    }
    var client = new OSS.Wrapper({
        region: 'oss-cn-hangzhou',
        accessKeyId: 'O2zXL39br8rSn1zC',
        accessKeySecret: 'XvHmCScXX9CiuMBRJ743yJdPoEiKTe',
        secure:true,
        bucket: 'products-image'
    });
    $("#upFile").change(function(e){
        var file = e.target.files[0];
        var storeAs="/collocation/rendering"+new Date().getTime()+'.jpg';
        if($("#daipei_list img").length>=2){
            art.dialog({
                time: 1,
                lock:true,
                cancel: false,
                content: "最多能添加两张"
            });
            $("#upFile").val("");
            return;
        }
        client.multipartUpload(storeAs, file).then(function (result) {
            var storeAs='https://products-image.oss-cn-hangzhou.aliyuncs.com/'+result.name;
            $("#daipei_list ul .add").before("<li><i class='icon-ishop_6-12'></i><img src='"+storeAs+"@150h_150w_1e_1c' alt='' data-src='"+result.name+"' data-img='"+storeAs+"'></li>");
            $("#upFile").val("");
        }).catch(function (err) {
            // console.log(err);
        });
    })
    $("#daipei_list").on("click","li i",function(){
        var key=$(this).parent("li").find("img").attr("data-src");
        deleteUrl(key);
        $(this).parent("li").remove();
    });
    function deleteUrl(key){
        console.log(key);
        var storeAs=key;
        client.delete(storeAs).then(function (result) {
            console.log(result);
        }).catch(function (err) {

        });
    };
    $("#daipei_list").on("mouseover","li",function(){
        $(this).find("i").show();
    });
    $("#daipei_list").on("mouseout","li",function(){
        $(this).find("i").hide();
    });
</script>
</body>
</html>